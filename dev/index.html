<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · MLNanoShaper.jl</title><meta name="title" content="Home · MLNanoShaper.jl"/><meta property="og:title" content="Home · MLNanoShaper.jl"/><meta property="twitter:title" content="Home · MLNanoShaper.jl"/><meta name="description" content="Documentation for MLNanoShaper.jl."/><meta property="og:description" content="Documentation for MLNanoShaper.jl."/><meta property="twitter:description" content="Documentation for MLNanoShaper.jl."/><meta property="og:url" content="https://concept-lab.github.io/MLNanoShaper.jl/"/><meta property="twitter:url" content="https://concept-lab.github.io/MLNanoShaper.jl/"/><link rel="canonical" href="https://concept-lab.github.io/MLNanoShaper.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>MLNanoShaper.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li><li><a class="tocitem" href="loss/">Custom Loss</a></li><li><a class="tocitem" href="model/">Building Custom Models</a></li><li><a class="tocitem" href="cli/">CLI Interface</a></li><li><a class="tocitem" href="evaluation/">model evaluation</a></li><li><a class="tocitem" href="so/">C Interface</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/concept-lab/MLNanoShaper.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="MLNanoShaper"><a class="docs-heading-anchor" href="#MLNanoShaper">MLNanoShaper</a><a id="MLNanoShaper-1"></a><a class="docs-heading-anchor-permalink" href="#MLNanoShaper" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/hack-hard/MLNanoShaper.jl">MLNanoShaper</a>. MLNanoShaper is a machine learning algorithm that can compute the surface of proteins.   There are multiple ways to interface with the software.</p><ul><li>As julia Modules <code>MLNanoShaper</code> and <code>MLNanoShaperRunner</code></li><li>As a cli command mlnanoshaper in <code>~/.julia/bin</code>.</li><li>As a training script <code>script/training.bash</code> that run multiple training runs. Requires parallel.</li><li>Running only: as a .so object.</li></ul><ul><li><a href="#MLNanoShaper.AccumulatorLogger"><code>MLNanoShaper.AccumulatorLogger</code></a></li><li><a href="#MLNanoShaper.AdamDelta"><code>MLNanoShaper.AdamDelta</code></a></li><li><a href="#MLNanoShaper.AnnotedKDTree"><code>MLNanoShaper.AnnotedKDTree</code></a></li><li><a href="#MLNanoShaper.AuxiliaryParameters"><code>MLNanoShaper.AuxiliaryParameters</code></a></li><li><a href="#MLNanoShaper.LossType"><code>MLNanoShaper.LossType</code></a></li><li><a href="#MLNanoShaper.TrainingData"><code>MLNanoShaper.TrainingData</code></a></li><li><a href="#MLNanoShaper.TrainingParameters"><code>MLNanoShaper.TrainingParameters</code></a></li><li><a href="#MLNanoShaperRunner.Batch"><code>MLNanoShaperRunner.Batch</code></a></li><li><a href="#MLNanoShaperRunner.ConcatenatedBatch"><code>MLNanoShaperRunner.ConcatenatedBatch</code></a></li><li><a href="#MLNanoShaperRunner.ModelInput"><code>MLNanoShaperRunner.ModelInput</code></a></li><li><a href="#MLNanoShaperRunner.Option"><code>MLNanoShaperRunner.Option</code></a></li><li><a href="#MLNanoShaperRunner.RegularGrid-Union{Tuple{G}, Tuple{T}, Tuple{AbstractVector{G}, T}, Tuple{AbstractVector{G}, T, Function}} where {T, G}"><code>MLNanoShaperRunner.RegularGrid</code></a></li><li><a href="#MLNanoShaperRunner.RegularGrid"><code>MLNanoShaperRunner.RegularGrid</code></a></li><li><a href="#MLNanoShaper._train-Tuple{MLNanoShaper.TrainingParameters, MLNanoShaper.AuxiliaryParameters}"><code>MLNanoShaper._train</code></a></li><li><a href="#MLNanoShaper.categorical_loss-NTuple{4, Any}"><code>MLNanoShaper.categorical_loss</code></a></li><li><a href="#MLNanoShaper.continuous_loss-NTuple{4, Any}"><code>MLNanoShaper.continuous_loss</code></a></li><li><a href="#MLNanoShaper.distance-Tuple{AbstractVector{&lt;:AbstractVector}, NearestNeighbors.KDTree}"><code>MLNanoShaper.distance</code></a></li><li><a href="#MLNanoShaper.generate_data-Tuple{}"><code>MLNanoShaper.generate_data</code></a></li><li><a href="#MLNanoShaper.generate_data_points-Tuple{LuxCore.AbstractLuxLayer, AbstractVector{GeometryBasics.Point{3, Float32}}, MLNanoShaper.TreeTrainingData{Float32}, MLNanoShaper.TrainingParameters}"><code>MLNanoShaper.generate_data_points</code></a></li><li><a href="#MLNanoShaper.implicit_surface-Union{Tuple{T}, Tuple{Lux.StatefulLuxLayer, MLNanoShaperRunner.RegularGrid{T}}} where T"><code>MLNanoShaper.implicit_surface</code></a></li><li><a href="#MLNanoShaper.load_data_pqr-Tuple{Type{&lt;:Number}, String}"><code>MLNanoShaper.load_data_pqr</code></a></li><li><a href="#MLNanoShaper.signed_distance-Union{Tuple{T}, Tuple{GeometryBasics.Point3{T}, MLNanoShaper.RegionMesh}} where T&lt;:Number"><code>MLNanoShaper.signed_distance</code></a></li><li><a href="#MLNanoShaperRunner.batched_sum-Tuple{AbstractMatrix, Any, AbstractVector}"><code>MLNanoShaperRunner.batched_sum</code></a></li><li><a href="#MLNanoShaperRunner.eval_model"><code>MLNanoShaperRunner.eval_model</code></a></li><li><a href="#MLNanoShaperRunner.eval_model-Tuple{Ptr{MLNanoShaperRunner.CPoint}, Int32}"><code>MLNanoShaperRunner.eval_model</code></a></li><li><a href="#MLNanoShaperRunner.get_cutoff_radius-Tuple{LuxCore.AbstractLuxLayer}"><code>MLNanoShaperRunner.get_cutoff_radius</code></a></li><li><a href="#MLNanoShaperRunner.light_angular_dense-Tuple{}"><code>MLNanoShaperRunner.light_angular_dense</code></a></li><li><a href="#MLNanoShaperRunner.light_soft_max_angular_dense-Tuple{}"><code>MLNanoShaperRunner.light_soft_max_angular_dense</code></a></li><li><a href="#MLNanoShaperRunner.load_atoms"><code>MLNanoShaperRunner.load_atoms</code></a></li><li><a href="#MLNanoShaperRunner.load_model"><code>MLNanoShaperRunner.load_model</code></a></li><li><a href="#MLNanoShaperRunner.medium_angular_dense-Tuple{}"><code>MLNanoShaperRunner.medium_angular_dense</code></a></li><li><a href="#MLNanoShaperRunner.production_instantiate-Tuple{MLNanoShaperRunner.SerializedModel}"><code>MLNanoShaperRunner.production_instantiate</code></a></li><li><a href="#MLNanoShaperRunner.tiny_angular_dense-Tuple{}"><code>MLNanoShaperRunner.tiny_angular_dense</code></a></li><li><a href="#MLNanoShaperRunner.tiny_soft_max_angular_dense-Tuple{}"><code>MLNanoShaperRunner.tiny_soft_max_angular_dense</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.AccumulatorLogger" href="#MLNanoShaper.AccumulatorLogger"><code>MLNanoShaper.AccumulatorLogger</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">accumulator(processing,logger)</code></pre><p>A processing logger that transform logger on multiple batches Ca be used to liss numerical data, for logging to TensorBoardLogger.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/77c93aba84b01c022a4fb880d7eeff77c02e23dd/src/logging.jl#L2-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.AdamDelta" href="#MLNanoShaper.AdamDelta"><code>MLNanoShaper.AdamDelta</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AdamDelta(ρ = 0.9, ϵ = 1e-8)
AdaDelta(; [rho, epsilon])</code></pre><p><strong>Parameters</strong></p><ul><li>Rho (<code>ρ == rho</code>): Factor by which the gradient is decayed at each time step.</li><li>Machine epsilon (<code>ϵ == epsilon</code>): Constant to prevent division by zero                        (no need to change default)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/77c93aba84b01c022a4fb880d7eeff77c02e23dd/src/optimiser.jl#L3-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.AnnotedKDTree" href="#MLNanoShaper.AnnotedKDTree"><code>MLNanoShaper.AnnotedKDTree</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AnnotedKDTree(data::StructVector,property::StaticSymbol)</code></pre><p><strong>Fields</strong></p><ul><li>data::StructVector</li><li>tree::KDTree</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/77c93aba84b01c022a4fb880d7eeff77c02e23dd/src/preprocessing.jl#L31-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.AuxiliaryParameters" href="#MLNanoShaper.AuxiliaryParameters"><code>MLNanoShaper.AuxiliaryParameters</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AuxiliaryParameters</code></pre><p>The variables that do not influence the outome of the training run. This include the nb_epoch.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/77c93aba84b01c022a4fb880d7eeff77c02e23dd/src/conf.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.LossType" href="#MLNanoShaper.LossType"><code>MLNanoShaper.LossType</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">abstract type LossType end</code></pre><p>LossType is an interface for defining loss functions.</p><p><strong>Implementation</strong></p><ul><li>get<em>loss</em>fn(::LossType)::Function : the associated loss function</li><li><em>metric</em>type(::Type{&lt;:LossType)::Type : the type of metrics returned by the loss function</li><li><em>get</em>loss<em>type(::StaticSymbol)::LossType : the function generating the loss</em>type</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/77c93aba84b01c022a4fb880d7eeff77c02e23dd/src/loss.jl#L123-L130">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.TrainingData" href="#MLNanoShaper.TrainingData"><code>MLNanoShaper.TrainingData</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Training information used in model training.</p><p><strong>Fields</strong></p><ul><li><code>atoms</code>: the set of atoms used as model input</li><li><code>skin</code> : the Surface generated by Nanoshaper</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/77c93aba84b01c022a4fb880d7eeff77c02e23dd/src/preprocessing.jl#L19-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.TrainingParameters" href="#MLNanoShaper.TrainingParameters"><code>MLNanoShaper.TrainingParameters</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TrainingParameters</code></pre><p>The training parameters used in the model training. Default values are in the param file. The training is deterministric. Theses values are hased to determine a training run</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/77c93aba84b01c022a4fb880d7eeff77c02e23dd/src/conf.jl#L17-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper._train-Tuple{MLNanoShaper.TrainingParameters, MLNanoShaper.AuxiliaryParameters}" href="#MLNanoShaper._train-Tuple{MLNanoShaper.TrainingParameters, MLNanoShaper.AuxiliaryParameters}"><code>MLNanoShaper._train</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_train(training_parameters::TrainingParameters, directories::AuxiliaryParameters)</code></pre><p>train the model given <code>TrainingParameters</code> and <code>AuxiliaryParameters</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/77c93aba84b01c022a4fb880d7eeff77c02e23dd/src/training.jl#L222-L226">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.categorical_loss-NTuple{4, Any}" href="#MLNanoShaper.categorical_loss-NTuple{4, Any}"><code>MLNanoShaper.categorical_loss</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">categorical_loss(model, ps, st, (; point, atoms, d_real))</code></pre><p>The loss function used by in training. Return the KL divergence between true probability and empirical probability Return the error with the espected distance as a metric.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/77c93aba84b01c022a4fb880d7eeff77c02e23dd/src/loss.jl#L202-L208">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.continuous_loss-NTuple{4, Any}" href="#MLNanoShaper.continuous_loss-NTuple{4, Any}"><code>MLNanoShaper.continuous_loss</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">continus_loss(model, ps, st, (; point, atoms, d_real))</code></pre><p>The loss function used by in training. compare the predicted (square) distance with <span>$\frac{1 + 	anh(d)}{2}$</span> Return the error with the espected distance as a metric.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/77c93aba84b01c022a4fb880d7eeff77c02e23dd/src/loss.jl#L273-L279">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.distance-Tuple{AbstractVector{&lt;:AbstractVector}, NearestNeighbors.KDTree}" href="#MLNanoShaper.distance-Tuple{AbstractVector{&lt;:AbstractVector}, NearestNeighbors.KDTree}"><code>MLNanoShaper.distance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">distance(x::GeometryBasics.Mesh, y::KDTree)</code></pre><p>Return the Hausdorff distance betwen the mesh coordinates</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/77c93aba84b01c022a4fb880d7eeff77c02e23dd/src/preprocessing.jl#L145-L149">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.generate_data-Tuple{}" href="#MLNanoShaper.generate_data-Tuple{}"><code>MLNanoShaper.generate_data</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_data()</code></pre><p>generate data from the parameters files in <code>param/</code> by downloading the pdb files and running Nanoshaper. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/77c93aba84b01c022a4fb880d7eeff77c02e23dd/src/generate_data.jl#L2-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.generate_data_points-Tuple{LuxCore.AbstractLuxLayer, AbstractVector{GeometryBasics.Point{3, Float32}}, MLNanoShaper.TreeTrainingData{Float32}, MLNanoShaper.TrainingParameters}" href="#MLNanoShaper.generate_data_points-Tuple{LuxCore.AbstractLuxLayer, AbstractVector{GeometryBasics.Point{3, Float32}}, MLNanoShaper.TreeTrainingData{Float32}, MLNanoShaper.TrainingParameters}"><code>MLNanoShaper.generate_data_points</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_data_points(
    preprocessing::Lux.AbstractExplicitLayer, points::AbstractVector{&lt;:Point3},
    (; atoms, skin)::TreeTrainingData{Float32}, (; ref_distance)::TrainingParameters)</code></pre><p>generate the data_points for a set of positions <code>points</code> on one protein.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/77c93aba84b01c022a4fb880d7eeff77c02e23dd/src/preprocessing.jl#L85-L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.implicit_surface-Union{Tuple{T}, Tuple{Lux.StatefulLuxLayer, MLNanoShaperRunner.RegularGrid{T}}} where T" href="#MLNanoShaper.implicit_surface-Union{Tuple{T}, Tuple{Lux.StatefulLuxLayer, MLNanoShaperRunner.RegularGrid{T}}} where T"><code>MLNanoShaper.implicit_surface</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">implicit_surface(atoms::RegularGrid{T},
    model::Lux.StatefulLuxLayer, (;
        cutoff_radius, step)) where {T}

Create a mesh form the isosurface of function `pos -&gt; model(atoms,pos)` using marching cubes algorithm and using step size `step`.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/77c93aba84b01c022a4fb880d7eeff77c02e23dd/src/training.jl#L9-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.load_data_pqr-Tuple{Type{&lt;:Number}, String}" href="#MLNanoShaper.load_data_pqr-Tuple{Type{&lt;:Number}, String}"><code>MLNanoShaper.load_data_pqr</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_data_pqr(T, name::String)</code></pre><p>Load a <code>TrainingData{T}</code> from current directory. You should have a pdb and an off file with name <code>name</code> in current directory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/77c93aba84b01c022a4fb880d7eeff77c02e23dd/src/preprocessing.jl#L118-L123">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.signed_distance-Union{Tuple{T}, Tuple{GeometryBasics.Point3{T}, MLNanoShaper.RegionMesh}} where T&lt;:Number" href="#MLNanoShaper.signed_distance-Union{Tuple{T}, Tuple{GeometryBasics.Point3{T}, MLNanoShaper.RegionMesh}} where T&lt;:Number"><code>MLNanoShaper.signed_distance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">signed_distance(p::Point3, mesh::RegionMesh)::Number</code></pre><p>returns the signed distance between point p and the mesh a positive distance means that we are inside the mesh</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/77c93aba84b01c022a4fb880d7eeff77c02e23dd/src/preprocessing.jl#L130-L135">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.Option" href="#MLNanoShaperRunner.Option"><code>MLNanoShaperRunner.Option</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">state</code></pre><p>The global state manipulated by the c interface. To use, you must first load the weights using <code>load_weights</code> and the input atoms using <code>load_atoms</code>. Then you can call eval_model to get the field on a certain point.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/2b124cdc2d8322c9846968098abe04fd7270e2dc/src/c_interface.jl#L9-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.Batch" href="#MLNanoShaperRunner.Batch"><code>MLNanoShaperRunner.Batch</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Batch  A wrapper arround a vector to design a variable dimension</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/2b124cdc2d8322c9846968098abe04fd7270e2dc/src/batchs.jl#L2-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.ConcatenatedBatch" href="#MLNanoShaperRunner.ConcatenatedBatch"><code>MLNanoShaperRunner.ConcatenatedBatch</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ConcatenatedBatch</code></pre><p>Represent a vector of arrays of sizes (a..., b<em>n) where b</em>n is the variable dimension of the batch. You can access view of individual arrays with <code>get_slice</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/2b124cdc2d8322c9846968098abe04fd7270e2dc/src/batchs.jl#L19-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.ModelInput" href="#MLNanoShaperRunner.ModelInput"><code>MLNanoShaperRunner.ModelInput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ModelInput</code></pre><p>input of the model</p><p><strong>Fields</strong></p><ul><li>point::Point3, the position of the input</li><li>atoms::StructVector{Sphere}, the atoms in the neighboord</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/2b124cdc2d8322c9846968098abe04fd7270e2dc/src/layers.jl#L17-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.RegularGrid" href="#MLNanoShaperRunner.RegularGrid"><code>MLNanoShaperRunner.RegularGrid</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct RegularGrid{T&lt;:Number,G,F&lt;:Function}</code></pre><p>A structure representing the input of the surface prediction model</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/2b124cdc2d8322c9846968098abe04fd7270e2dc/src/distance_tree.jl#L6-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.RegularGrid-Union{Tuple{G}, Tuple{T}, Tuple{AbstractVector{G}, T}, Tuple{AbstractVector{G}, T, Function}} where {T, G}" href="#MLNanoShaperRunner.RegularGrid-Union{Tuple{G}, Tuple{T}, Tuple{AbstractVector{G}, T}, Tuple{AbstractVector{G}, T, Function}} where {T, G}"><code>MLNanoShaperRunner.RegularGrid</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>RegularGrid(spheres::AbstractVector,radius::Number,[center])  A constructor that take a vector of spheres. If you are not using Geometry basic spheres, you will need to give a function center that return the center of each point.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/2b124cdc2d8322c9846968098abe04fd7270e2dc/src/distance_tree.jl#L27-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.batched_sum-Tuple{AbstractMatrix, Any, AbstractVector}" href="#MLNanoShaperRunner.batched_sum-Tuple{AbstractMatrix, Any, AbstractVector}"><code>MLNanoShaperRunner.batched_sum</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">batched_sum(b::AbstractMatrix,nb_elements::AbstractVector)</code></pre><p>compute the sum of a Concatenated batch with ndim  = 2. The first dim is the feature dimension. The second dim is the the batch dim.</p><p>Given <code>b</code> of size (n,m) and <code>nb_elements</code> of size (k,), the output has size (n,k).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/2b124cdc2d8322c9846968098abe04fd7270e2dc/src/operations.jl#L33-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.eval_model" href="#MLNanoShaperRunner.eval_model"><code>MLNanoShaperRunner.eval_model</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eval_model(x::Float32,y::Float32,z::Float32)::Float32</code></pre><p>evaluate the model at coordinates <code>x</code> <code>y</code> <code>z</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/2b124cdc2d8322c9846968098abe04fd7270e2dc/src/c_interface.jl#L61-L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.eval_model-Tuple{Ptr{MLNanoShaperRunner.CPoint}, Int32}" href="#MLNanoShaperRunner.eval_model-Tuple{Ptr{MLNanoShaperRunner.CPoint}, Int32}"><code>MLNanoShaperRunner.eval_model</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">evaluate_model</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/2b124cdc2d8322c9846968098abe04fd7270e2dc/src/c_interface.jl#L107-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.get_cutoff_radius-Tuple{LuxCore.AbstractLuxLayer}" href="#MLNanoShaperRunner.get_cutoff_radius-Tuple{LuxCore.AbstractLuxLayer}"><code>MLNanoShaperRunner.get_cutoff_radius</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_cutoff_radius(x::Lux.AbstractLuxLayer)</code></pre><p>extract the cutoff radius of a Lux Model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/2b124cdc2d8322c9846968098abe04fd7270e2dc/src/models.jl#L301-L304">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.light_angular_dense-Tuple{}" href="#MLNanoShaperRunner.light_angular_dense-Tuple{}"><code>MLNanoShaperRunner.light_angular_dense</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">light_angular_dense(; categorical=false, van_der_waals_channel=false, kargs...)

`light_angular_dense` is a function that generate a lux model.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/2b124cdc2d8322c9846968098abe04fd7270e2dc/src/models.jl#L163-L168">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.light_soft_max_angular_dense-Tuple{}" href="#MLNanoShaperRunner.light_soft_max_angular_dense-Tuple{}"><code>MLNanoShaperRunner.light_soft_max_angular_dense</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">light_soft_max_angular_dense(; categorical=false, van_der_waals_channel=false, kargs...)

`light_soft_max_angular_dense` is a function that generate a lux model.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/2b124cdc2d8322c9846968098abe04fd7270e2dc/src/models.jl#L193-L198">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.load_atoms" href="#MLNanoShaperRunner.load_atoms"><code>MLNanoShaperRunner.load_atoms</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_atoms(start::Ptr{CSphere},length::Cint)::Cint</code></pre><p>Load the atoms into the julia model. Start is a pointer to the start of the array of <code>CSphere</code> and <code>length</code> is the length of the array</p><p><strong>Return an error status:</strong></p><ul><li>0: OK</li><li>1: data could not be read</li><li>2: unknow error</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/2b124cdc2d8322c9846968098abe04fd7270e2dc/src/c_interface.jl#L48-L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.load_model" href="#MLNanoShaperRunner.load_model"><code>MLNanoShaperRunner.load_model</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_model(path::String)::Cint</code></pre><p>Load the model from a <code>MLNanoShaperRunner.SerializedModel</code> serialized state at absolute path <code>path</code>.</p><p><strong>Return an error status:</strong></p><ul><li>0: OK</li><li>1: file not found</li><li>2: file could not be deserialized properly</li><li>3: unknow error</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/2b124cdc2d8322c9846968098abe04fd7270e2dc/src/c_interface.jl#L36-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.medium_angular_dense-Tuple{}" href="#MLNanoShaperRunner.medium_angular_dense-Tuple{}"><code>MLNanoShaperRunner.medium_angular_dense</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">medium_angular_dense(; categorical=false, van_der_waals_channel=false, kargs...)

`medium_angular_dense` is a function that generate a lux model.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/2b124cdc2d8322c9846968098abe04fd7270e2dc/src/models.jl#L225-L230">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.production_instantiate-Tuple{MLNanoShaperRunner.SerializedModel}" href="#MLNanoShaperRunner.production_instantiate-Tuple{MLNanoShaperRunner.SerializedModel}"><code>MLNanoShaperRunner.production_instantiate</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">production_instantiate(model::SerializedModel;[on_gpu])::Lux.StatefullLuxLayer{true}</code></pre><p>Turn a SerializedModel into a Stateful Lux Layer. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/2b124cdc2d8322c9846968098abe04fd7270e2dc/src/models.jl#L292-L295">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.tiny_angular_dense-Tuple{}" href="#MLNanoShaperRunner.tiny_angular_dense-Tuple{}"><code>MLNanoShaperRunner.tiny_angular_dense</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tiny_angular_dense(; categorical=false, van_der_waals_channel=false, kargs...)

`tiny_angular_dense` is a function that generate a lux model.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/2b124cdc2d8322c9846968098abe04fd7270e2dc/src/models.jl#L90-L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.tiny_soft_max_angular_dense-Tuple{}" href="#MLNanoShaperRunner.tiny_soft_max_angular_dense-Tuple{}"><code>MLNanoShaperRunner.tiny_soft_max_angular_dense</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tiny_angular_dense(; categorical=false, van_der_waals_channel=false, kargs...)

`tiny_angular_dense` is a function that generate a lux model.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/2b124cdc2d8322c9846968098abe04fd7270e2dc/src/models.jl#L128-L133">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="loss/">Custom Loss »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 29 July 2025 11:52">Tuesday 29 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
