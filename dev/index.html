<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · MLNanoShaper.jl</title><meta name="title" content="Home · MLNanoShaper.jl"/><meta property="og:title" content="Home · MLNanoShaper.jl"/><meta property="twitter:title" content="Home · MLNanoShaper.jl"/><meta name="description" content="Documentation for MLNanoShaper.jl."/><meta property="og:description" content="Documentation for MLNanoShaper.jl."/><meta property="twitter:description" content="Documentation for MLNanoShaper.jl."/><meta property="og:url" content="https://concept-lab.github.io/MLNanoShaper.jl/"/><meta property="twitter:url" content="https://concept-lab.github.io/MLNanoShaper.jl/"/><link rel="canonical" href="https://concept-lab.github.io/MLNanoShaper.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>MLNanoShaper.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/concept-lab/MLNanoShaper.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="MLNanoShaper"><a class="docs-heading-anchor" href="#MLNanoShaper">MLNanoShaper</a><a id="MLNanoShaper-1"></a><a class="docs-heading-anchor-permalink" href="#MLNanoShaper" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/hack-hard/MLNanoShaper.jl">MLNanoShaper</a>.</p><ul><li><a href="#MLNanoShaper.AccumulatorLogger"><code>MLNanoShaper.AccumulatorLogger</code></a></li><li><a href="#MLNanoShaper.AuxiliaryParameters"><code>MLNanoShaper.AuxiliaryParameters</code></a></li><li><a href="#MLNanoShaper.TrainingData"><code>MLNanoShaper.TrainingData</code></a></li><li><a href="#MLNanoShaper.TrainingParameters"><code>MLNanoShaper.TrainingParameters</code></a></li><li><a href="#MLNanoShaperRunner.AnnotedKDTree"><code>MLNanoShaperRunner.AnnotedKDTree</code></a></li><li><a href="#MLNanoShaperRunner.ConcatenatedBatch"><code>MLNanoShaperRunner.ConcatenatedBatch</code></a></li><li><a href="#MLNanoShaperRunner.ModelInput"><code>MLNanoShaperRunner.ModelInput</code></a></li><li><a href="#MLNanoShaperRunner.Option"><code>MLNanoShaperRunner.Option</code></a></li><li><a href="#MLNanoShaper.categorical_loss-Tuple{Any, Any, Any, @NamedTuple{points::Vector{GeometryBasics.Point{3, Float32}}, inputs::MLNanoShaperRunner.ConcatenatedBatch{&lt;:StructArrays.StructArray{MLNanoShaperRunner.PreprocessData{Float32}}}, d_reals::Vector{Float32}}}"><code>MLNanoShaper.categorical_loss</code></a></li><li><a href="#MLNanoShaper.comonicon_install-Tuple{}"><code>MLNanoShaper.comonicon_install</code></a></li><li><a href="#MLNanoShaper.comonicon_install_path-Tuple{}"><code>MLNanoShaper.comonicon_install_path</code></a></li><li><a href="#MLNanoShaper.continus_loss-Tuple{Any, Any, Any, @NamedTuple{points::Vector{GeometryBasics.Point{3, Float32}}, inputs::MLNanoShaperRunner.ConcatenatedBatch{&lt;:StructArrays.StructArray{MLNanoShaperRunner.PreprocessData{Float32}}}, d_reals::Vector{Float32}}}"><code>MLNanoShaper.continus_loss</code></a></li><li><a href="#MLNanoShaper.evaluate_model-Tuple{Lux.StatefulLuxLayer, GeometryBasics.Point{3, Float32}, MLNanoShaperRunner.AnnotedKDTree}"><code>MLNanoShaper.evaluate_model</code></a></li><li><a href="#MLNanoShaper.generate_data-Tuple{}"><code>MLNanoShaper.generate_data</code></a></li><li><a href="#MLNanoShaper.generate_data_points-Tuple{LuxCore.AbstractExplicitLayer, AbstractVector{&lt;:GeometryBasics.Point3}, MLNanoShaper.TreeTrainingData{Float32}, MLNanoShaper.TrainingParameters}"><code>MLNanoShaper.generate_data_points</code></a></li><li><a href="#MLNanoShaper.implicit_surface-Union{Tuple{T}, Tuple{MLNanoShaperRunner.AnnotedKDTree{GeometryBasics.Sphere{T}, :center, GeometryBasics.Point3{T}}, Lux.StatefulLuxLayer, Any}} where T"><code>MLNanoShaper.implicit_surface</code></a></li><li><a href="#MLNanoShaper.load_data_pdb-Tuple{Type{&lt;:Number}, String}"><code>MLNanoShaper.load_data_pdb</code></a></li><li><a href="#MLNanoShaper.load_data_pqr-Tuple{Type{&lt;:Number}, String}"><code>MLNanoShaper.load_data_pqr</code></a></li><li><a href="#MLNanoShaper.train-Tuple{MLNanoShaper.TrainingParameters, MLNanoShaper.AuxiliaryParameters}"><code>MLNanoShaper.train</code></a></li><li><a href="#MLNanoShaper.train-Tuple{Tuple{MLUtils.AbstractDataContainer, MLUtils.AbstractDataContainer}, Lux.Experimental.TrainState, MLNanoShaper.TrainingParameters, MLNanoShaper.AuxiliaryParameters}"><code>MLNanoShaper.train</code></a></li><li><a href="#MLNanoShaper.train"><code>MLNanoShaper.train</code></a></li><li><a href="#MLNanoShaperRunner.anakin-Tuple{}"><code>MLNanoShaperRunner.anakin</code></a></li><li><a href="#MLNanoShaperRunner.distance-Tuple{AbstractVector{&lt;:AbstractVector}, NearestNeighbors.KDTree}"><code>MLNanoShaperRunner.distance</code></a></li><li><a href="#MLNanoShaperRunner.eval_model"><code>MLNanoShaperRunner.eval_model</code></a></li><li><a href="#MLNanoShaperRunner.load_atoms"><code>MLNanoShaperRunner.load_atoms</code></a></li><li><a href="#MLNanoShaperRunner.load_model"><code>MLNanoShaperRunner.load_model</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.AccumulatorLogger" href="#MLNanoShaper.AccumulatorLogger"><code>MLNanoShaper.AccumulatorLogger</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">accumulator(processing,logger)</code></pre><p>A processing logger that transform logger on multiple batches Ca be used to liss numerical data, for logging to TensorBoardLogger.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/ceff8c9203912cd52e5a23618c382d2d5ba04d50/src/logging.jl#L4-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.AuxiliaryParameters" href="#MLNanoShaper.AuxiliaryParameters"><code>MLNanoShaper.AuxiliaryParameters</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AuxiliaryParameters</code></pre><p>The variables that do not influence the outome of the training run. This include the nb_epoch.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/ceff8c9203912cd52e5a23618c382d2d5ba04d50/src/conf.jl#L6-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.TrainingData" href="#MLNanoShaper.TrainingData"><code>MLNanoShaper.TrainingData</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Training information used in model training.</p><p><strong>Fields</strong></p><ul><li><code>atoms</code>: the set of atoms used as model input</li><li><code>skin</code> : the Surface generated by Nanoshaper</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/ceff8c9203912cd52e5a23618c382d2d5ba04d50/src/preprocessing.jl#L28-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.TrainingParameters" href="#MLNanoShaper.TrainingParameters"><code>MLNanoShaper.TrainingParameters</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">TrainingParameters</code></pre><p>The training parameters used in the model training. Default values are in the param file. The training is deterministric. Theses values are hased to determine a training run</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/ceff8c9203912cd52e5a23618c382d2d5ba04d50/src/conf.jl#L21-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.categorical_loss-Tuple{Any, Any, Any, @NamedTuple{points::Vector{GeometryBasics.Point{3, Float32}}, inputs::MLNanoShaperRunner.ConcatenatedBatch{&lt;:StructArrays.StructArray{MLNanoShaperRunner.PreprocessData{Float32}}}, d_reals::Vector{Float32}}}" href="#MLNanoShaper.categorical_loss-Tuple{Any, Any, Any, @NamedTuple{points::Vector{GeometryBasics.Point{3, Float32}}, inputs::MLNanoShaperRunner.ConcatenatedBatch{&lt;:StructArrays.StructArray{MLNanoShaperRunner.PreprocessData{Float32}}}, d_reals::Vector{Float32}}}"><code>MLNanoShaper.categorical_loss</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">categorical_loss(model, ps, st, (; point, atoms, d_real))</code></pre><p>The loss function used by in training. Return the KL divergence between true probability and empirical probability Return the error with the espected distance as a metric.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/ceff8c9203912cd52e5a23618c382d2d5ba04d50/src/training.jl#L113-L119">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.comonicon_install-Tuple{}" href="#MLNanoShaper.comonicon_install-Tuple{}"><code>MLNanoShaper.comonicon_install</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">comonicon_install(;kwargs...)</code></pre><p>Install the CLI manually. This will use the default configuration in <code>Comonicon.toml</code>, if it exists. For more detailed reference, please refer to <a href="https://comonicon.org">Comonicon documentation</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/comonicon/Comonicon.jl/blob/v1.0.8/src/frontend/cast.jl#L488-L494">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.comonicon_install_path-Tuple{}" href="#MLNanoShaper.comonicon_install_path-Tuple{}"><code>MLNanoShaper.comonicon_install_path</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">comonicon_install_path(;[yes=false])</code></pre><p>Install the <code>PATH</code> and <code>FPATH</code> to your shell configuration file. You can use <code>comonicon_install_path(;yes=true)</code> to skip interactive prompt. For more detailed reference, please refer to <a href="https://comonicon.org">Comonicon documentation</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/comonicon/Comonicon.jl/blob/v1.0.8/src/frontend/cast.jl#L497-L504">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.continus_loss-Tuple{Any, Any, Any, @NamedTuple{points::Vector{GeometryBasics.Point{3, Float32}}, inputs::MLNanoShaperRunner.ConcatenatedBatch{&lt;:StructArrays.StructArray{MLNanoShaperRunner.PreprocessData{Float32}}}, d_reals::Vector{Float32}}}" href="#MLNanoShaper.continus_loss-Tuple{Any, Any, Any, @NamedTuple{points::Vector{GeometryBasics.Point{3, Float32}}, inputs::MLNanoShaperRunner.ConcatenatedBatch{&lt;:StructArrays.StructArray{MLNanoShaperRunner.PreprocessData{Float32}}}, d_reals::Vector{Float32}}}"><code>MLNanoShaper.continus_loss</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">continus_loss(model, ps, st, (; point, atoms, d_real))</code></pre><p>The loss function used by in training. compare the predicted (square) distance with <span>$\frac{1 + 	anh(d)}{2}$</span> Return the error with the espected distance as a metric.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/ceff8c9203912cd52e5a23618c382d2d5ba04d50/src/training.jl#L157-L163">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.evaluate_model-Tuple{Lux.StatefulLuxLayer, GeometryBasics.Point{3, Float32}, MLNanoShaperRunner.AnnotedKDTree}" href="#MLNanoShaper.evaluate_model-Tuple{Lux.StatefulLuxLayer, GeometryBasics.Point{3, Float32}, MLNanoShaperRunner.AnnotedKDTree}"><code>MLNanoShaper.evaluate_model</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">evaluate_model(
    model::Lux.StatefulLuxLayer, x::Point3f, atoms::AnnotedKDTree; cutoff_radius, default_value = -0.0f0)

evaluate the model on a single point.
This function handle the logic in case the point is too far from the atoms. In this case default_value is returned and the model is not run.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/ceff8c9203912cd52e5a23618c382d2d5ba04d50/src/training.jl#L200-L206">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.generate_data-Tuple{}" href="#MLNanoShaper.generate_data-Tuple{}"><code>MLNanoShaper.generate_data</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">generate_data()</code></pre><p>generate data from the parameters files in <code>param/</code> by downloading the pdb files and running Nanoshaper. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/ceff8c9203912cd52e5a23618c382d2d5ba04d50/src/generate_data.jl#L7-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.generate_data_points-Tuple{LuxCore.AbstractExplicitLayer, AbstractVector{&lt;:GeometryBasics.Point3}, MLNanoShaper.TreeTrainingData{Float32}, MLNanoShaper.TrainingParameters}" href="#MLNanoShaper.generate_data_points-Tuple{LuxCore.AbstractExplicitLayer, AbstractVector{&lt;:GeometryBasics.Point3}, MLNanoShaper.TreeTrainingData{Float32}, MLNanoShaper.TrainingParameters}"><code>MLNanoShaper.generate_data_points</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">generate_data_points(
    preprocessing::Lux.AbstractExplicitLayer, points::AbstractVector{&lt;:Point3},
    (; atoms, skin)::TreeTrainingData{Float32}, (; ref_distance)::TrainingParameters)</code></pre><p>generate the data_points for a set of positions <code>points</code> on one protein.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/ceff8c9203912cd52e5a23618c382d2d5ba04d50/src/preprocessing.jl#L79-L85">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.implicit_surface-Union{Tuple{T}, Tuple{MLNanoShaperRunner.AnnotedKDTree{GeometryBasics.Sphere{T}, :center, GeometryBasics.Point3{T}}, Lux.StatefulLuxLayer, Any}} where T" href="#MLNanoShaper.implicit_surface-Union{Tuple{T}, Tuple{MLNanoShaperRunner.AnnotedKDTree{GeometryBasics.Sphere{T}, :center, GeometryBasics.Point3{T}}, Lux.StatefulLuxLayer, Any}} where T"><code>MLNanoShaper.implicit_surface</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">implicit_surface(atoms::AnnotedKDTree{Sphere{T}, :center, Point3{T}},
    model::Lux.StatefulLuxLayer, (;
        cutoff_radius, step)) where {T}

Create a mesh form the isosurface of function `pos -&gt; model(atoms,pos)` using marching cubes algorithm and using step size `step`.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/ceff8c9203912cd52e5a23618c382d2d5ba04d50/src/training.jl#L229-L235">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.load_data_pdb-Tuple{Type{&lt;:Number}, String}" href="#MLNanoShaper.load_data_pdb-Tuple{Type{&lt;:Number}, String}"><code>MLNanoShaper.load_data_pdb</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load_data_pdb(T, name::String)</code></pre><p>Load a <code>TrainingData{T}</code> from current directory. You should have a pdb and an off file with name <code>name</code> in current directory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/ceff8c9203912cd52e5a23618c382d2d5ba04d50/src/preprocessing.jl#L105-L110">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.load_data_pqr-Tuple{Type{&lt;:Number}, String}" href="#MLNanoShaper.load_data_pqr-Tuple{Type{&lt;:Number}, String}"><code>MLNanoShaper.load_data_pqr</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load_data_pqr(T, name::String)</code></pre><p>Load a <code>TrainingData{T}</code> from current directory. You should have a pdb and an off file with name <code>name</code> in current directory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/ceff8c9203912cd52e5a23618c382d2d5ba04d50/src/preprocessing.jl#L114-L119">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.train" href="#MLNanoShaper.train"><code>MLNanoShaper.train</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">train [options] [flags]</code></pre><p>Train a model.</p><p><strong>Intro</strong></p><p>Parameters are specified in the <code>param/param.toml</code> file. The folowing parameters can be overided.</p><p><strong>Options</strong></p><ul><li><code>--nb-epoch, -e &lt;Int&gt;</code>: the number of epoch to compute.</li><li><code>--model, -m &lt;String&gt;</code>: the model name. Can be anakin.</li><li><code>--nb-data-points, -d &lt;Int&gt;</code>: the number of proteins in the dataset to use</li><li><code>--name, -n &lt;String&gt;</code>: name of the training run</li><li><code>--cutoff-radius, -c &lt;Float32&gt;</code>: the cutoff_radius used in training</li><li><code>--ref-distance, -d &lt;Float32&gt;</code>: the reference distane (in A) used to rescale distance to surface in loss</li></ul><p><strong>Flags</strong></p><ul><li><code>--gpu, -g</code>: should we do the training on the gpu</li><li><code>--categorical, -c</code>: should we use the categorical version of the model</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/ceff8c9203912cd52e5a23618c382d2d5ba04d50/src/cli.jl#L13-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.train-Tuple{MLNanoShaper.TrainingParameters, MLNanoShaper.AuxiliaryParameters}" href="#MLNanoShaper.train-Tuple{MLNanoShaper.TrainingParameters, MLNanoShaper.AuxiliaryParameters}"><code>MLNanoShaper.train</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">train(training_parameters::TrainingParameters, directories::AuxiliaryParameters)</code></pre><p>train the model given <code>TrainingParameters</code> and <code>AuxiliaryParameters</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/ceff8c9203912cd52e5a23618c382d2d5ba04d50/src/training.jl#L399-L403">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaper.train-Tuple{Tuple{MLUtils.AbstractDataContainer, MLUtils.AbstractDataContainer}, Lux.Experimental.TrainState, MLNanoShaper.TrainingParameters, MLNanoShaper.AuxiliaryParameters}" href="#MLNanoShaper.train-Tuple{Tuple{MLUtils.AbstractDataContainer, MLUtils.AbstractDataContainer}, Lux.Experimental.TrainState, MLNanoShaper.TrainingParameters, MLNanoShaper.AuxiliaryParameters}"><code>MLNanoShaper.train</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">train((train_data,test_data),training_states; nb_epoch)</code></pre><p>train the model on the data with nb_epoch</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaper.jl/blob/ceff8c9203912cd52e5a23618c382d2d5ba04d50/src/training.jl#L307-L310">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.Option" href="#MLNanoShaperRunner.Option"><code>MLNanoShaperRunner.Option</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">state</code></pre><p>The global state manipulated by the c interface. To use, you must first load the weights using <code>load_weights</code> and the input atoms using <code>load_atoms</code>. Then you can call eval_model to get the field on a certain point.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/4aeae27c4ea0b61050fec403f4586de21a5c4c54/src/c_interface.jl#L10-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.AnnotedKDTree" href="#MLNanoShaperRunner.AnnotedKDTree"><code>MLNanoShaperRunner.AnnotedKDTree</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AnnotedKDTree(data::StructVector,property::StaticSymbol)</code></pre><p><strong>Fields</strong></p><ul><li>data::StructVector</li><li>tree::KDTree</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/4aeae27c4ea0b61050fec403f4586de21a5c4c54/src/layers.jl#L191-L196">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.ConcatenatedBatch" href="#MLNanoShaperRunner.ConcatenatedBatch"><code>MLNanoShaperRunner.ConcatenatedBatch</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ConcatenatedBatch</code></pre><p>Represent a vector of arrays of sizes (a..., b<em>n) where b</em>n is the variable dimension of the batch. You can access view of individual arrays with <code>get_slice</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/4aeae27c4ea0b61050fec403f4586de21a5c4c54/src/layers.jl#L22-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.ModelInput" href="#MLNanoShaperRunner.ModelInput"><code>MLNanoShaperRunner.ModelInput</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ModelInput</code></pre><p>input of the model</p><p><strong>Fields</strong></p><ul><li>point::Point3, the position of the input</li><li>atoms::StructVector{Sphere}, the atoms in the neighboord</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/4aeae27c4ea0b61050fec403f4586de21a5c4c54/src/layers.jl#L36-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.anakin-Tuple{}" href="#MLNanoShaperRunner.anakin-Tuple{}"><code>MLNanoShaperRunner.anakin</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">anakin()</code></pre><p>A model inspired by the anakin paper. The protein is decomposed in pairs of atom near the interest point. Each pair of atom is turned into a <code>Preprocessed</code> data and is then fed to the <code>Encoding</code> layer. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/4aeae27c4ea0b61050fec403f4586de21a5c4c54/src/models.jl#L19-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.distance-Tuple{AbstractVector{&lt;:AbstractVector}, NearestNeighbors.KDTree}" href="#MLNanoShaperRunner.distance-Tuple{AbstractVector{&lt;:AbstractVector}, NearestNeighbors.KDTree}"><code>MLNanoShaperRunner.distance</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">distance(x::GeometryBasics.Mesh, y::KDTree)</code></pre><p>Return the Hausdorff distance betwen the mesh coordinates</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/4aeae27c4ea0b61050fec403f4586de21a5c4c54/src/distance_tree.jl#L45-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.eval_model" href="#MLNanoShaperRunner.eval_model"><code>MLNanoShaperRunner.eval_model</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">eval_model(x::Float32,y::Float32,z::Float32)::Float32</code></pre><p>evaluate the model at coordinates <code>x</code> <code>y</code> <code>z</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/4aeae27c4ea0b61050fec403f4586de21a5c4c54/src/c_interface.jl#L58-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.load_atoms" href="#MLNanoShaperRunner.load_atoms"><code>MLNanoShaperRunner.load_atoms</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">load_atoms(start::Ptr{CSphere},length::Cint)::Cint</code></pre><p>Load the atoms into the julia model. Start is a pointer to the start of the array of <code>CSphere</code> and <code>length</code> is the length of the array</p><p><strong>Return an error status:</strong></p><ul><li>0: OK</li><li>1: data could not be read</li><li>2: unknow error</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/4aeae27c4ea0b61050fec403f4586de21a5c4c54/src/c_interface.jl#L45-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLNanoShaperRunner.load_model" href="#MLNanoShaperRunner.load_model"><code>MLNanoShaperRunner.load_model</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">load_model(path::String)::Cint</code></pre><p>Load the model from a <code>MLNanoShaperRunner.SerializedModel</code> serialized state at absolute path <code>path</code>.</p><p><strong>Return an error status:</strong></p><ul><li>0: OK</li><li>1: file not found</li><li>2: file could not be deserialized properly</li><li>3: unknow error</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/concept-lab/MLNanoShaperRunner.jl/blob/4aeae27c4ea0b61050fec403f4586de21a5c4c54/src/c_interface.jl#L33-L43">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Thursday 25 July 2024 15:29">Thursday 25 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
